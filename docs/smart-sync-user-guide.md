# 智能同步功能使用指南

## 🎯 功能概述

基于 Anki 的成功经验，我们重新设计了数据存储和同步策略，实现了"本地优先 + 智能同步"的模式，大幅减少云端数据压力，同时提升用户体验。

## ✨ 核心优势

### 1. **本地优先，响应更快**
- 所有操作首先在本地完成，无网络延迟
- 即使离线也能正常使用所有功能
- 数据安全性更高，始终在您的设备上

### 2. **智能分类，精选同步**
- 自动识别数据重要性：核心/重要/可选/临时
- 只同步真正需要的数据到云端
- 大幅减少网络流量和云端存储

### 3. **用户控制，按需同步**
- 您决定何时同步，不再频繁自动上传
- 同步前可预览内容和大小
- 支持快速同步(仅核心数据)和完整同步

## 📊 数据分类策略

### 🔥 **核心数据 (自动推荐同步)**
- ✅ **收藏卡片**: 您精心收藏的学习内容
- ✅ **用户偏好**: 主题、难度等个人设置
- ✅ **学习进度**: 重要的学习统计数据

### 🟡 **重要数据 (可选同步)**
- 📚 **活跃会话**: 有收藏内容或近期使用的学习会话
- 📊 **详细统计**: 学习时长、互动记录等

### ⭕ **临时数据 (仅本地存储)**
- 💬 **日常对话**: 普通的问答对话
- 🗑️ **过期会话**: 长时间未使用且无重要内容的会话
- 🔄 **缓存数据**: 临时文件和调试信息

## 🚀 使用方法

### 1. **查看同步状态**

**位置**: 仪表板页面顶部
- 绿色图标 ✅: 数据已同步
- 橙色图标 ⚠️: 有数据待同步
- 红色图标 ❌: 同步失败

**信息显示**:
- 待同步项目数量
- 估计数据大小
- 上次同步时间

### 2. **执行同步操作**

#### 快速同步 (推荐)
```
点击 "快速同步" 按钮
```
- 仅同步核心数据(收藏卡片、用户设置等)
- 速度最快，消耗最少
- 适合日常使用

#### 完整同步
```
点击 "完整同步" 按钮
```
- 同步核心数据 + 重要数据
- 包含活跃的学习会话
- 适合重要节点或设备切换前

#### 预览同步内容
```
点击 "预览" 按钮
```
- 查看具体将同步哪些数据
- 显示每项数据的大小
- 估算同步时间

### 3. **数据生命周期管理**

**位置**: 仪表板底部的"数据生命周期管理"面板

#### 查看存储统计
- 学习会话总数
- 收藏卡片数量
- 临时数据数量
- 总存储大小

#### 清理临时数据
```
1. 设置清理天数 (默认30天)
2. 点击 "清理数据" 按钮
3. 确认清理操作
```
**清理规则**:
- 只清理无收藏内容的会话
- 只清理超过指定天数未更新的数据
- 重要数据永远不会被清理

#### 导出数据备份
```
点击 "导出备份" 按钮
```
- 下载包含所有本地数据的JSON文件
- 可用于数据迁移或灾难恢复
- 建议定期备份

## 💡 最佳实践

### 1. **日常使用建议**
- 正常学习时无需关心同步，专注内容
- 收藏重要内容时，系统会自动标记为需同步
- 每次学习结束后，可选择快速同步保存重要数据

### 2. **定期维护建议**
- **每周**: 检查同步状态，执行快速同步
- **每月**: 执行完整同步，清理临时数据
- **季度**: 导出数据备份，检查存储空间

### 3. **跨设备使用**
- 新设备登录后，首次会从云端恢复核心数据
- 重要会话可通过完整同步获取
- 临时对话数据不会跨设备传输(这是设计特性)

## 📈 性能对比

### 优化前 vs 优化后

| 指标 | 优化前 | 优化后 | 改善 |
|------|--------|--------|------|
| 云端API调用 | 每次操作 | 用户主动 | ↓ 80% |
| 月度云端记录 | 1000+ 条 | 50-100 条 | ↓ 70% |
| 响应速度 | 300-800ms | 50-100ms | ↑ 90% |
| 离线可用性 | 部分功能 | 完整功能 | ↑ 100% |
| 网络依赖 | 强依赖 | 可选依赖 | 大幅减少 |

## 🔧 高级设置

### 自定义同步策略
未来版本将支持：
- 自定义数据重要性分类
- 设置自动同步触发条件
- 配置数据保留策略

### 开发者选项
对于高级用户：
- 可通过浏览器开发者工具查看详细同步日志
- 本地数据存储在 localStorage 中，可手动检查
- 支持导入/导出配置文件

## ❓ 常见问题

### Q: 如果我忘记同步，数据会丢失吗？
A: 不会。所有数据首先保存在本地，即使从不同步也不会丢失。云端同步只是为了跨设备访问的便利。

### Q: 同步失败怎么办？
A: 系统会保留本地数据并显示错误信息。您可以检查网络连接后重试，或联系技术支持。

### Q: 可以回到原来的自动同步模式吗？
A: 当前版本专注于用户控制的同步模式。如果您需要自动同步，可以通过设置定期提醒来实现类似效果。

### Q: 临时数据被清理后能恢复吗？
A: 被清理的临时数据无法恢复。建议在清理前检查是否有需要保留的内容，或先进行数据备份。

---

## 📞 技术支持

如果您在使用过程中遇到问题或有改进建议，请通过以下方式联系我们：
- 在应用内反馈
- 查看更多文档
- 联系技术支持

感谢您使用智能同步功能！这个设计将帮助您更高效地管理学习数据，同时减少不必要的网络开销。